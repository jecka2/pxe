1
```bash
jecka@debian:~/git/pxe$ ansible-playbook create_vm.yml --ask-vault-pass
Vault password: 

PLAY [Create vms on Proxmox] ************************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************************************************************************
[WARNING]: Host 'pve' is using the discovered Python interpreter at '/usr/bin/python3.13', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/devel/reference_appendices/interpreter_discovery.html for more information.
ok: [pve]

TASK [Install python] *******************************************************************************************************************************************************************************************************************************************************
ok: [pve]

TASK [INstall pip modules] **************************************************************************************************************************************************************************************************************************************************
ok: [pve]

TASK [Install pip modules] **************************************************************************************************************************************************************************************************************************************************
ok: [pve]

TASK [Install pip modules] **************************************************************************************************************************************************************************************************************************************************
ok: [pve]

TASK [clone KVM VM 1 from template] *****************************************************************************************************************************************************************************************************************************************
changed: [pve] => (item={'name': 'TFTP', 'ip_address': '192.168.1.106/24', 'memory': '1024'})
changed: [pve] => (item={'name': 'client', 'ip_address': 'dhcp', 'memory': '1024'})

TASK [Update VM configs] ****************************************************************************************************************************************************************************************************************************************************
changed: [pve] => (item={'name': 'TFTP', 'ip_address': '192.168.1.106/24', 'memory': '1024'})
changed: [pve] => (item={'name': 'client', 'ip_address': 'dhcp', 'memory': '1024'})

TASK [Start VM] *************************************************************************************************************************************************************************************************************************************************************
changed: [pve]

PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************
pve                        : ok=8    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
```

```bash
jecka@debian:~/git/pxe$ ansible-playbook config_server.yml --ask-vault-pass
Vault password: 

PLAY [Install  & config PXE server] *****************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************************************************************************
[WARNING]: Host 'TFTP' is using the discovered Python interpreter at '/usr/bin/python3.12', but future installation of another Python interpreter could cause a different interpreter to be discovered. See https://docs.ansible.com/ansible-core/devel/reference_appendices/interpreter_discovery.html for more information.
ok: [TFTP]

TASK [Install required packages] ********************************************************************************************************************************************************************************************************************************************
changed: [TFTP]

TASK [Create directory structure] *******************************************************************************************************************************************************************************************************************************************
ok: [TFTP] => (item=/srv/tftp)
changed: [TFTP] => (item=/srv/tftp/pxelinux.cfg)
changed: [TFTP] => (item=/srv/tftp/ubuntu-24.04)
ok: [TFTP] => (item=/var/www/html)

TASK [Download Ubuntu 24.04.3 netboot files] ********************************************************************************************************************************************************************************************************************************
changed: [TFTP] => (item=ubuntu-installer/amd64/linux)
changed: [TFTP] => (item=ubuntu-installer/amd64/initrd.gz)

TASK [Copy SYSLINUX files to TFTP root] *************************************************************************************************************************************************************************************************************************************
changed: [TFTP] => (item=ldlinux.c32)
changed: [TFTP] => (item=libutil.c32)
changed: [TFTP] => (item=menu.c32)
changed: [TFTP] => (item=libcom32.c32)

TASK [Copy pxelinux.0 to TFTP root] *****************************************************************************************************************************************************************************************************************************************
changed: [TFTP]

TASK [Configure TFTP server] ************************************************************************************************************************************************************************************************************************************************
changed: [TFTP]

TASK [Create PXE menu configuration] ****************************************************************************************************************************************************************************************************************************************
changed: [TFTP]

TASK [Configure Nginx for HTTP serving] *************************************************************************************************************************************************************************************************************************************
changed: [TFTP]

TASK [Enable Nginx site] ****************************************************************************************************************************************************************************************************************************************************
changed: [TFTP]

TASK [Disable default Nginx site] *******************************************************************************************************************************************************************************************************************************************
changed: [TFTP]

TASK [Ensure services are enabled and started] ******************************************************************************************************************************************************************************************************************************
ok: [TFTP] => (item=tftpd-hpa)
ok: [TFTP] => (item=nginx)

TASK [Verify netboot files] *************************************************************************************************************************************************************************************************************************************************
ok: [TFTP] => (item=linux)
ok: [TFTP] => (item=initrd.gz)

RUNNING HANDLER [restart tftpd-hpa] *****************************************************************************************************************************************************************************************************************************************
changed: [TFTP]

PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************
TFTP                       : ok=14   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

```
 

 После выполнения данных оперций и включив  на вашем DHCP 
 ОПЦИЯ 66 - Указать ip адрес PXE сервера 
 ОПЦИЯ 67 -  Укзать в качестве опции файл pxelinux.0


 После данных действий при запуске виртуальных  или физических машин и настройке их загружаться по сети. Они смогут производить загрузку/установку ОС с сервера PXE развернутого в нашей сети.

 ![Указание что , машина увидела возможность загрузки по сети ](https://raw.githubusercontent.com/jecka2/pxe/refs/heads/main/pxe_boot.png)
 ![Список возможных загрузок](https://raw.githubusercontent.com/jecka2/pxe/refs/heads/main/pxe_menu.png)
 ![Процесс установки](https://raw.githubusercontent.com/jecka2/pxe/refs/heads/main/screenshots/install_menu.png)